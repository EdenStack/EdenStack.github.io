---
layout:     post
title:      Activity生命周期
date:       2015-06-20 10:47:18
summary:    Activity lifcyle.
author:     Tneciv
categories: android
thumbnail: android
tags:
 - android
 - activity
 - lifecyle
---

&emsp;&emsp;不同于其他编程范式（程序从main()方法开始启动），Android系统根据生命周期的不同阶段唤起对应的回调函数来执行代码。系统存在启动与销毁一个``activity``的一套有序的回调函数。

&emsp;&emsp;本节介绍生命周期中最重要的回调函数，并演示如何处理启动一个``activity``所涉及到的回调函数。

##理解生命周期的回调

&emsp;&emsp;在一个``activity``的生命周期中，系统会像金字塔模型一样去调用一系列的生命周期回调函数。``Activity``生命周期的每一个阶段就像金字塔中的台阶。当系统创建了一个新的``activity``实例，每一个回调函数会向上一阶移动``activity``状态。处在金字塔顶端意味着当前``activity``处在前台并处于用户可与其进行交互的状态。

&emsp;&emsp;当用户退出这个``activity``时，为了回收该``activity``，系统会调用其它方法来向下一阶移动``activity``状态。在某些情况下，``activity``会隐藏在金字塔下等待(例如当用户切换到其他app),此时``activity``可以重新回到顶端(如果用户回到这个``activity``)并恢复用户离开时的状态。

![生命周期](http://i.imgur.com/6MnA9s6.png)

**Figure 1.** 下面这张图讲解了activity的生命周期：(这个金字塔模型要比之前Dev Guide里面的生命周期图更加容易理解，更加形象)

&emsp;&emsp;根据activity的复杂度，也许不需要实现所有的生命周期方法。但了解每一个方法的回调时机并在其中填充相应功能，使得确保app能够像用户期望的那样执行是很有必要的。如何实现一个符合用户期待的app，我们需要注意下面几点：

> * 使用app的时候，不会因为有来电通话或者切换到其他app而导致程序crash。
> * 用户没有激活某个组件时不会消耗宝贵的系统资源。
> * 离开app并且一段时间后返回，不会丢失用户的使用进度。
> * 设备发生屏幕旋转时不会crash或者丢失用户的使用进度。


&emsp;&emsp;下面的课程会介绍上图所示的几个生命状态。然而，其中只有三个状态是静态的，这三个状态下activity可以存在一段比较长的时间。(其它几个状态会很快就切换掉，停留的时间比较短暂)

> * Resumed：该状态下，activity处在前台，用户可以与它进行交互。(通常也被理解为"running" 状态)
> * Paused：该状态下，activity的部分被另外一个activity所遮盖：另外的activity来到前台，但是半透明的，不会覆盖整个屏幕。被暂停的activity不再接受用户的输入且不再执行任何代码。
> * Stopped：该状态下, activity完全被隐藏，对用户不可见。可以认为是在后台。当stopped, activity实例与它的所有状态信息（如成员变量等）都会被保留，但activity不能执行任何代码。

&emsp;&emsp;其它状态 **(Created**与**Started)**都是短暂的，系统快速的执行那些回调函数并通过执行下一阶段的回调函数移动到下一个状态。也就是说，在系统调用onCreate(), 之后会迅速调用onStart(), 之后再迅速执行onResume()。以上就是基本的activity生命周期。

